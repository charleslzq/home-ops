{
  "version": 4,
  "terraform_version": "1.0.2",
  "serial": 26,
  "lineage": "4bc2b70e-794b-8345-d84b-355c816b8e98",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "consul_keys",
      "name": "config",
      "provider": "provider[\"registry.terraform.io/hashicorp/consul\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "datacenter": "dc1",
            "id": "-",
            "key": [
              {
                "default": "",
                "name": "proxmox_url",
                "path": "proxmox/url"
              },
              {
                "default": "",
                "name": "vault_token",
                "path": "vault-keys/token/vault-token"
              }
            ],
            "namespace": null,
            "token": null,
            "var": {
              "proxmox_url": "https://10.10.30.168:8006/api2/json",
              "vault_token": "s.hZGdJQU0r00SBnamCOAC0LE5"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "vault_generic_secret",
      "name": "proxmox_credentials",
      "provider": "provider[\"registry.terraform.io/hashicorp/vault\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "data": {
              "password": "Forever!6+7",
              "username": "root@pam"
            },
            "data_json": "{\"password\":\"Forever!6+7\",\"username\":\"root@pam\"}",
            "id": "secret/home/proxmox",
            "lease_duration": 0,
            "lease_id": "",
            "lease_renewable": false,
            "lease_start_time": "RFC2229",
            "path": "secret/home/proxmox",
            "version": -1
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.local_vault",
      "mode": "managed",
      "type": "vault_mount",
      "name": "vm-client-signer",
      "provider": "provider[\"registry.terraform.io/hashicorp/vault\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "accessor": "ssh_d40fac98",
            "default_lease_ttl_seconds": 0,
            "description": "",
            "external_entropy_access": false,
            "id": "vm-client-signer",
            "local": false,
            "max_lease_ttl_seconds": 0,
            "options": {},
            "path": "vm-client-signer",
            "seal_wrap": false,
            "type": "ssh"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.consul_keys.config"
          ]
        }
      ]
    },
    {
      "module": "module.local_vault",
      "mode": "managed",
      "type": "vault_ssh_secret_backend_ca",
      "name": "ca",
      "provider": "provider[\"registry.terraform.io/hashicorp/vault\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "backend": "vm-client-signer",
            "generate_signing_key": true,
            "id": "vm-client-signer",
            "private_key": null,
            "public_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.consul_keys.config",
            "module.local_vault.vault_mount.vm-client-signer"
          ]
        }
      ]
    },
    {
      "module": "module.local_vault",
      "mode": "managed",
      "type": "vault_ssh_secret_backend_role",
      "name": "mac",
      "provider": "provider[\"registry.terraform.io/hashicorp/vault\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "algorithm_signer": "rsa-sha2-512",
            "allow_bare_domains": false,
            "allow_host_certificates": false,
            "allow_subdomains": false,
            "allow_user_certificates": true,
            "allow_user_key_ids": false,
            "allowed_critical_options": "",
            "allowed_domains": "",
            "allowed_extensions": "permit-pty,permit-port-forwarding",
            "allowed_user_key_lengths": {},
            "allowed_users": "*",
            "allowed_users_template": false,
            "backend": "vm-client-signer",
            "cidr_list": "",
            "default_critical_options": {},
            "default_extensions": {
              "permit-pty": ""
            },
            "default_user": "ubuntu",
            "id": "vm-client-signer/roles/mac",
            "key_id_format": "",
            "key_type": "ca",
            "max_ttl": "0",
            "name": "mac",
            "ttl": "1800"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.consul_keys.config",
            "module.local_vault.vault_mount.vm-client-signer"
          ]
        }
      ]
    },
    {
      "module": "module.proxmox",
      "mode": "data",
      "type": "vault_generic_secret",
      "name": "consul_config",
      "provider": "provider[\"registry.terraform.io/hashicorp/vault\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "data": {
              "ca_cert": "-----BEGIN CERTIFICATE-----\nMIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\nMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\nMRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\nBgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\nMTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\nMDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\nEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\nZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\nLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\nNzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\nqaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\nFy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\nAQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\nBgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\nhkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\nXClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n-----END CERTIFICATE-----",
              "ca_key": "-----BEGIN EC PRIVATE KEY-----\nMHcCAQEEIHN7lQblZv4IDHIJl29jN1Z64siHxhBdWHCxnHsV707coAoGCCqGSM49\nAwEHoUQDQgAEf/6poEY1d+Y3tcl6sUEuONXSsP0EMgXV4kN5RACPl7jRRpLl1mFa\nliDSSkwcD7goEC4XLTud1TsX8CVwk7bKfA==\n-----END EC PRIVATE KEY-----",
              "encrypt_key": "Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=",
              "gateway": "10.10.30.1",
              "server_1_cert": "-----BEGIN CERTIFICATE-----\nMIICpjCCAk2gAwIBAgIRAJbMFDcOrU53uJ1JwfhqqI4wCgYIKoZIzj0EAwIwgbkx\nCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\nbzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\nFQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\nIDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\nMTAwMjM2MjBaFw0yMjA4MTAwMjM2MjBaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\nZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATBBqg659F2c8+O\nnViRXCJO0HO420muDIXt9QPpCJX/M/bIyz/IIL7JmBXSGRwcdsEvgUEf0IBJfzWX\n/j6PDMSJo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\nAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgSWw3XvbVNMhNpnSQ\n8RypjusZaRuTn9fA7KlQ77lV89cwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\nxNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\nbnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0cAMEQCIDaHCIcdEJdE\nUC9F02G/Ydw07nz4/lchTHX8sx14NpKZAiBZ5+ACFFcPM/DbpD0adJPyEwjL/CmY\nffCgXfcXrOVrbg==\n-----END CERTIFICATE-----",
              "server_1_ip": "10.10.30.99",
              "server_1_key": "-----BEGIN EC PRIVATE KEY-----\nMHcCAQEEIC6N4oAsZOshX2ldfjeEA3iSYRVBEQKOdrlXFp5geZkHoAoGCCqGSM49\nAwEHoUQDQgAEwQaoOufRdnPPjp1YkVwiTtBzuNtJrgyF7fUD6QiV/zP2yMs/yCC+\nyZgV0hkcHHbBL4FBH9CASX81l/4+jwzEiQ==\n-----END EC PRIVATE KEY-----",
              "server_1_proxmox_node": "avalon",
              "server_2_cert": "-----BEGIN CERTIFICATE-----\nMIICpzCCAkygAwIBAgIQPDZwz2G8laEsCqDqPfTvUzAKBggqhkjOPQQDAjCBuTEL\nMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\nMRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\nBgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\nMTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\nMDAyMzcwNloXDTIyMDgxMDAyMzcwNlowITEfMB0GA1UEAxMWc2VydmVyLnJheWxl\naWdoLmNvbnN1bDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJGVbDsQ5pi+xQNy\ngjSuzeMZ9XI8x3VM/JHUs29AHJmCr9gamIdFURADcm9LNxq5yGTjEcu1dWVpfgal\nesPjLq6jgcwwgckwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMB\nBggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMCkGA1UdDgQiBCBBWCLuozz/wcv63Sl+\nHuBVMml8JEUkFYzT/QrakzDY9TArBgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE\n2L7mFiV93a2lC1aP6xJc3zAyBgNVHREEKzApghZzZXJ2ZXIucmF5bGVpZ2guY29u\nc3Vsgglsb2NhbGhvc3SHBH8AAAEwCgYIKoZIzj0EAwIDSQAwRgIhAPi4Lm4x4OO5\nOEBbeFX0jxwkkhF04kikCpuAMqH0qQfpAiEAy0/OY0vE6mP0T+KH1mSfNDEbTh6I\n0VJzjqMmQ1Fbzi8=\n-----END CERTIFICATE-----",
              "server_2_ip": "10.10.30.100",
              "server_2_key": "-----BEGIN EC PRIVATE KEY-----\nMHcCAQEEICm+QSgr0qJG0C4kKKwEXLmaa8A6Jd8nGB9tZoIygesYoAoGCCqGSM49\nAwEHoUQDQgAEkZVsOxDmmL7FA3KCNK7N4xn1cjzHdUz8kdSzb0AcmYKv2BqYh0VR\nEANyb0s3GrnIZOMRy7V1ZWl+BqV6w+Murg==\n-----END EC PRIVATE KEY-----",
              "server_2_proxmox_node": "skypiea",
              "server_3_cert": "-----BEGIN CERTIFICATE-----\nMIICqDCCAk2gAwIBAgIRAM+wX1p9xL9Y5QgSMPdoCWQwCgYIKoZIzj0EAwIwgbkx\nCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\nbzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\nFQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\nIDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\nMTAwMjM3MDdaFw0yMjA4MTAwMjM3MDdaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\nZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASLUQdY9KOz/76D\nhpue/erFWF6Om7uFLncy8hCz00KaSTB412ElNIBtT59ftUPsu75I7YnlJ4Kf8qo4\nN3uw+WzCo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\nAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgQxlyuL8KQd9Mwj3M\nu1x9D4wO7pWeU+IublKxSoZ6CpAwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\nxNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\nbnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0kAMEYCIQCYBeSJ3WOv\nWO/jrdOIo1vKMomDfVZ8Hh1w9n/t8+ziBwIhALQJbGsxv96gKfEmcxh624syGXBC\nskzUwQf5XNYARQaV\n-----END CERTIFICATE-----",
              "server_3_ip": "10.10.30.101",
              "server_3_key": "-----BEGIN EC PRIVATE KEY-----\nMHcCAQEEIC5ByiRFJaGg4eU4F7PPhspehHDDzwrKu0IfJevvUqQroAoGCCqGSM49\nAwEHoUQDQgAEi1EHWPSjs/++g4abnv3qxVhejpu7hS53MvIQs9NCmkkweNdhJTSA\nbU+fX7VD7Lu+SO2J5SeCn/KqODd7sPlswg==\n-----END EC PRIVATE KEY-----",
              "server_3_proxmox_node": "skypiea",
              "servers": "[{\"cert\":\"-----BEGIN CERTIFICATE-----\\nMIICpjCCAk2gAwIBAgIRAJbMFDcOrU53uJ1JwfhqqI4wCgYIKoZIzj0EAwIwgbkx\\nCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\\nbzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\\nFQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\\nIDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\\nMTAwMjM2MjBaFw0yMjA4MTAwMjM2MjBaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\\nZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATBBqg659F2c8+O\\nnViRXCJO0HO420muDIXt9QPpCJX/M/bIyz/IIL7JmBXSGRwcdsEvgUEf0IBJfzWX\\n/j6PDMSJo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\\nAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgSWw3XvbVNMhNpnSQ\\n8RypjusZaRuTn9fA7KlQ77lV89cwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\\nxNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\\nbnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0cAMEQCIDaHCIcdEJdE\\nUC9F02G/Ydw07nz4/lchTHX8sx14NpKZAiBZ5+ACFFcPM/DbpD0adJPyEwjL/CmY\\nffCgXfcXrOVrbg==\\n-----END CERTIFICATE-----\",\"ip\":\"10.10.30.99\",\"key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEIC6N4oAsZOshX2ldfjeEA3iSYRVBEQKOdrlXFp5geZkHoAoGCCqGSM49\\nAwEHoUQDQgAEwQaoOufRdnPPjp1YkVwiTtBzuNtJrgyF7fUD6QiV/zP2yMs/yCC+\\nyZgV0hkcHHbBL4FBH9CASX81l/4+jwzEiQ==\\n-----END EC PRIVATE KEY-----\",\"proxmox_node\":\"avalon\"},{\"cert\":\"-----BEGIN CERTIFICATE-----\\nMIICpzCCAkygAwIBAgIQPDZwz2G8laEsCqDqPfTvUzAKBggqhkjOPQQDAjCBuTEL\\nMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\\nMRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\\nBgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\\nMTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\\nMDAyMzcwNloXDTIyMDgxMDAyMzcwNlowITEfMB0GA1UEAxMWc2VydmVyLnJheWxl\\naWdoLmNvbnN1bDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJGVbDsQ5pi+xQNy\\ngjSuzeMZ9XI8x3VM/JHUs29AHJmCr9gamIdFURADcm9LNxq5yGTjEcu1dWVpfgal\\nesPjLq6jgcwwgckwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMB\\nBggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMCkGA1UdDgQiBCBBWCLuozz/wcv63Sl+\\nHuBVMml8JEUkFYzT/QrakzDY9TArBgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE\\n2L7mFiV93a2lC1aP6xJc3zAyBgNVHREEKzApghZzZXJ2ZXIucmF5bGVpZ2guY29u\\nc3Vsgglsb2NhbGhvc3SHBH8AAAEwCgYIKoZIzj0EAwIDSQAwRgIhAPi4Lm4x4OO5\\nOEBbeFX0jxwkkhF04kikCpuAMqH0qQfpAiEAy0/OY0vE6mP0T+KH1mSfNDEbTh6I\\n0VJzjqMmQ1Fbzi8=\\n-----END CERTIFICATE-----\",\"ip\":\"10.10.30.100\",\"key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEICm+QSgr0qJG0C4kKKwEXLmaa8A6Jd8nGB9tZoIygesYoAoGCCqGSM49\\nAwEHoUQDQgAEkZVsOxDmmL7FA3KCNK7N4xn1cjzHdUz8kdSzb0AcmYKv2BqYh0VR\\nEANyb0s3GrnIZOMRy7V1ZWl+BqV6w+Murg==\\n-----END EC PRIVATE KEY-----\",\"proxmox_node\":\"skypiea\"},{\"cert\":\"-----BEGIN CERTIFICATE-----\\nMIICqDCCAk2gAwIBAgIRAM+wX1p9xL9Y5QgSMPdoCWQwCgYIKoZIzj0EAwIwgbkx\\nCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\\nbzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\\nFQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\\nIDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\\nMTAwMjM3MDdaFw0yMjA4MTAwMjM3MDdaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\\nZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASLUQdY9KOz/76D\\nhpue/erFWF6Om7uFLncy8hCz00KaSTB412ElNIBtT59ftUPsu75I7YnlJ4Kf8qo4\\nN3uw+WzCo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\\nAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgQxlyuL8KQd9Mwj3M\\nu1x9D4wO7pWeU+IublKxSoZ6CpAwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\\nxNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\\nbnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0kAMEYCIQCYBeSJ3WOv\\nWO/jrdOIo1vKMomDfVZ8Hh1w9n/t8+ziBwIhALQJbGsxv96gKfEmcxh624syGXBC\\nskzUwQf5XNYARQaV\\n-----END CERTIFICATE-----\",\"ip\":\"10.10.30.100\",\"key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEIC5ByiRFJaGg4eU4F7PPhspehHDDzwrKu0IfJevvUqQroAoGCCqGSM49\\nAwEHoUQDQgAEi1EHWPSjs/++g4abnv3qxVhejpu7hS53MvIQs9NCmkkweNdhJTSA\\nbU+fX7VD7Lu+SO2J5SeCn/KqODd7sPlswg==\\n-----END EC PRIVATE KEY-----\",\"proxmox_node\":\"skypiea\"}]"
            },
            "data_json": "{\"ca_cert\":\"-----BEGIN CERTIFICATE-----\\nMIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\\nMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\\nMRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\\nBgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\\nMTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\\nMDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\\nEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\\nZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\\nLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\\nNzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\\nqaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\\nFy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\\nAQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\\nBgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\\nhkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\\nXClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\\n-----END CERTIFICATE-----\",\"ca_key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEIHN7lQblZv4IDHIJl29jN1Z64siHxhBdWHCxnHsV707coAoGCCqGSM49\\nAwEHoUQDQgAEf/6poEY1d+Y3tcl6sUEuONXSsP0EMgXV4kN5RACPl7jRRpLl1mFa\\nliDSSkwcD7goEC4XLTud1TsX8CVwk7bKfA==\\n-----END EC PRIVATE KEY-----\",\"encrypt_key\":\"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\",\"gateway\":\"10.10.30.1\",\"server_1_cert\":\"-----BEGIN CERTIFICATE-----\\nMIICpjCCAk2gAwIBAgIRAJbMFDcOrU53uJ1JwfhqqI4wCgYIKoZIzj0EAwIwgbkx\\nCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\\nbzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\\nFQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\\nIDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\\nMTAwMjM2MjBaFw0yMjA4MTAwMjM2MjBaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\\nZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATBBqg659F2c8+O\\nnViRXCJO0HO420muDIXt9QPpCJX/M/bIyz/IIL7JmBXSGRwcdsEvgUEf0IBJfzWX\\n/j6PDMSJo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\\nAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgSWw3XvbVNMhNpnSQ\\n8RypjusZaRuTn9fA7KlQ77lV89cwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\\nxNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\\nbnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0cAMEQCIDaHCIcdEJdE\\nUC9F02G/Ydw07nz4/lchTHX8sx14NpKZAiBZ5+ACFFcPM/DbpD0adJPyEwjL/CmY\\nffCgXfcXrOVrbg==\\n-----END CERTIFICATE-----\",\"server_1_ip\":\"10.10.30.99\",\"server_1_key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEIC6N4oAsZOshX2ldfjeEA3iSYRVBEQKOdrlXFp5geZkHoAoGCCqGSM49\\nAwEHoUQDQgAEwQaoOufRdnPPjp1YkVwiTtBzuNtJrgyF7fUD6QiV/zP2yMs/yCC+\\nyZgV0hkcHHbBL4FBH9CASX81l/4+jwzEiQ==\\n-----END EC PRIVATE KEY-----\",\"server_1_proxmox_node\":\"avalon\",\"server_2_cert\":\"-----BEGIN CERTIFICATE-----\\nMIICpzCCAkygAwIBAgIQPDZwz2G8laEsCqDqPfTvUzAKBggqhkjOPQQDAjCBuTEL\\nMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\\nMRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\\nBgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\\nMTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\\nMDAyMzcwNloXDTIyMDgxMDAyMzcwNlowITEfMB0GA1UEAxMWc2VydmVyLnJheWxl\\naWdoLmNvbnN1bDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJGVbDsQ5pi+xQNy\\ngjSuzeMZ9XI8x3VM/JHUs29AHJmCr9gamIdFURADcm9LNxq5yGTjEcu1dWVpfgal\\nesPjLq6jgcwwgckwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMB\\nBggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMCkGA1UdDgQiBCBBWCLuozz/wcv63Sl+\\nHuBVMml8JEUkFYzT/QrakzDY9TArBgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE\\n2L7mFiV93a2lC1aP6xJc3zAyBgNVHREEKzApghZzZXJ2ZXIucmF5bGVpZ2guY29u\\nc3Vsgglsb2NhbGhvc3SHBH8AAAEwCgYIKoZIzj0EAwIDSQAwRgIhAPi4Lm4x4OO5\\nOEBbeFX0jxwkkhF04kikCpuAMqH0qQfpAiEAy0/OY0vE6mP0T+KH1mSfNDEbTh6I\\n0VJzjqMmQ1Fbzi8=\\n-----END CERTIFICATE-----\",\"server_2_ip\":\"10.10.30.100\",\"server_2_key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEICm+QSgr0qJG0C4kKKwEXLmaa8A6Jd8nGB9tZoIygesYoAoGCCqGSM49\\nAwEHoUQDQgAEkZVsOxDmmL7FA3KCNK7N4xn1cjzHdUz8kdSzb0AcmYKv2BqYh0VR\\nEANyb0s3GrnIZOMRy7V1ZWl+BqV6w+Murg==\\n-----END EC PRIVATE KEY-----\",\"server_2_proxmox_node\":\"skypiea\",\"server_3_cert\":\"-----BEGIN CERTIFICATE-----\\nMIICqDCCAk2gAwIBAgIRAM+wX1p9xL9Y5QgSMPdoCWQwCgYIKoZIzj0EAwIwgbkx\\nCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\\nbzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\\nFQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\\nIDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\\nMTAwMjM3MDdaFw0yMjA4MTAwMjM3MDdaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\\nZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASLUQdY9KOz/76D\\nhpue/erFWF6Om7uFLncy8hCz00KaSTB412ElNIBtT59ftUPsu75I7YnlJ4Kf8qo4\\nN3uw+WzCo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\\nAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgQxlyuL8KQd9Mwj3M\\nu1x9D4wO7pWeU+IublKxSoZ6CpAwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\\nxNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\\nbnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0kAMEYCIQCYBeSJ3WOv\\nWO/jrdOIo1vKMomDfVZ8Hh1w9n/t8+ziBwIhALQJbGsxv96gKfEmcxh624syGXBC\\nskzUwQf5XNYARQaV\\n-----END CERTIFICATE-----\",\"server_3_ip\":\"10.10.30.101\",\"server_3_key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEIC5ByiRFJaGg4eU4F7PPhspehHDDzwrKu0IfJevvUqQroAoGCCqGSM49\\nAwEHoUQDQgAEi1EHWPSjs/++g4abnv3qxVhejpu7hS53MvIQs9NCmkkweNdhJTSA\\nbU+fX7VD7Lu+SO2J5SeCn/KqODd7sPlswg==\\n-----END EC PRIVATE KEY-----\",\"server_3_proxmox_node\":\"skypiea\",\"servers\":[{\"cert\":\"-----BEGIN CERTIFICATE-----\\nMIICpjCCAk2gAwIBAgIRAJbMFDcOrU53uJ1JwfhqqI4wCgYIKoZIzj0EAwIwgbkx\\nCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\\nbzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\\nFQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\\nIDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\\nMTAwMjM2MjBaFw0yMjA4MTAwMjM2MjBaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\\nZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATBBqg659F2c8+O\\nnViRXCJO0HO420muDIXt9QPpCJX/M/bIyz/IIL7JmBXSGRwcdsEvgUEf0IBJfzWX\\n/j6PDMSJo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\\nAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgSWw3XvbVNMhNpnSQ\\n8RypjusZaRuTn9fA7KlQ77lV89cwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\\nxNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\\nbnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0cAMEQCIDaHCIcdEJdE\\nUC9F02G/Ydw07nz4/lchTHX8sx14NpKZAiBZ5+ACFFcPM/DbpD0adJPyEwjL/CmY\\nffCgXfcXrOVrbg==\\n-----END CERTIFICATE-----\",\"ip\":\"10.10.30.99\",\"key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEIC6N4oAsZOshX2ldfjeEA3iSYRVBEQKOdrlXFp5geZkHoAoGCCqGSM49\\nAwEHoUQDQgAEwQaoOufRdnPPjp1YkVwiTtBzuNtJrgyF7fUD6QiV/zP2yMs/yCC+\\nyZgV0hkcHHbBL4FBH9CASX81l/4+jwzEiQ==\\n-----END EC PRIVATE KEY-----\",\"proxmox_node\":\"avalon\"},{\"cert\":\"-----BEGIN CERTIFICATE-----\\nMIICpzCCAkygAwIBAgIQPDZwz2G8laEsCqDqPfTvUzAKBggqhkjOPQQDAjCBuTEL\\nMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\\nMRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\\nBgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\\nMTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\\nMDAyMzcwNloXDTIyMDgxMDAyMzcwNlowITEfMB0GA1UEAxMWc2VydmVyLnJheWxl\\naWdoLmNvbnN1bDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJGVbDsQ5pi+xQNy\\ngjSuzeMZ9XI8x3VM/JHUs29AHJmCr9gamIdFURADcm9LNxq5yGTjEcu1dWVpfgal\\nesPjLq6jgcwwgckwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMB\\nBggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMCkGA1UdDgQiBCBBWCLuozz/wcv63Sl+\\nHuBVMml8JEUkFYzT/QrakzDY9TArBgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE\\n2L7mFiV93a2lC1aP6xJc3zAyBgNVHREEKzApghZzZXJ2ZXIucmF5bGVpZ2guY29u\\nc3Vsgglsb2NhbGhvc3SHBH8AAAEwCgYIKoZIzj0EAwIDSQAwRgIhAPi4Lm4x4OO5\\nOEBbeFX0jxwkkhF04kikCpuAMqH0qQfpAiEAy0/OY0vE6mP0T+KH1mSfNDEbTh6I\\n0VJzjqMmQ1Fbzi8=\\n-----END CERTIFICATE-----\",\"ip\":\"10.10.30.100\",\"key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEICm+QSgr0qJG0C4kKKwEXLmaa8A6Jd8nGB9tZoIygesYoAoGCCqGSM49\\nAwEHoUQDQgAEkZVsOxDmmL7FA3KCNK7N4xn1cjzHdUz8kdSzb0AcmYKv2BqYh0VR\\nEANyb0s3GrnIZOMRy7V1ZWl+BqV6w+Murg==\\n-----END EC PRIVATE KEY-----\",\"proxmox_node\":\"skypiea\"},{\"cert\":\"-----BEGIN CERTIFICATE-----\\nMIICqDCCAk2gAwIBAgIRAM+wX1p9xL9Y5QgSMPdoCWQwCgYIKoZIzj0EAwIwgbkx\\nCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\\nbzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\\nFQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\\nIDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\\nMTAwMjM3MDdaFw0yMjA4MTAwMjM3MDdaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\\nZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASLUQdY9KOz/76D\\nhpue/erFWF6Om7uFLncy8hCz00KaSTB412ElNIBtT59ftUPsu75I7YnlJ4Kf8qo4\\nN3uw+WzCo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\\nAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgQxlyuL8KQd9Mwj3M\\nu1x9D4wO7pWeU+IublKxSoZ6CpAwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\\nxNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\\nbnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0kAMEYCIQCYBeSJ3WOv\\nWO/jrdOIo1vKMomDfVZ8Hh1w9n/t8+ziBwIhALQJbGsxv96gKfEmcxh624syGXBC\\nskzUwQf5XNYARQaV\\n-----END CERTIFICATE-----\",\"ip\":\"10.10.30.100\",\"key\":\"-----BEGIN EC PRIVATE KEY-----\\nMHcCAQEEIC5ByiRFJaGg4eU4F7PPhspehHDDzwrKu0IfJevvUqQroAoGCCqGSM49\\nAwEHoUQDQgAEi1EHWPSjs/++g4abnv3qxVhejpu7hS53MvIQs9NCmkkweNdhJTSA\\nbU+fX7VD7Lu+SO2J5SeCn/KqODd7sPlswg==\\n-----END EC PRIVATE KEY-----\",\"proxmox_node\":\"skypiea\"}]}",
            "id": "secret/home/consul",
            "lease_duration": 0,
            "lease_id": "",
            "lease_renewable": false,
            "lease_start_time": "RFC2229",
            "path": "secret/home/consul",
            "version": -1
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[0]",
      "mode": "data",
      "type": "cloudinit_config",
      "name": "config",
      "provider": "provider[\"registry.terraform.io/hashicorp/cloudinit\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base64_encode": false,
            "boundary": "MIMEBOUNDARY",
            "gzip": false,
            "id": "944120639",
            "part": [
              {
                "content": "#cloud-config\nusers:\n  - default\n  - name: ubuntu\n    shell: /bin/bash\n    home: /home/ubuntu\n    lock_passwd: true\n    groups: sudo, users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\nssh_deletekeys: true\nwrite_files:\n  - path: /etc/ssh/trusted-user-ca-keys.pem\n    content: |\n      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n\nbootcmd:\n  - cloud-init-per once ssh-users-ca echo \"TrustedUserCAKeys /etc/ssh/trusted-user-ca-keys.pem\" \u003e\u003e /etc/ssh/sshd_config\npackage_update: true\npackage_upgrade: true\nhostname: consul-server-1\npower_state:\n  timeout: 30\n  mode: reboot\n  message: Restarting",
                "content_type": "text/cloud-config",
                "filename": "",
                "merge_type": "list(append) + dict(no_replace, recurse_list) + str()"
              },
              {
                "content": "users:\n  - name: consul\n    system: true\nwrite_files:\n  - path: /etc/consul.d/consul.hcl\n    content: |\n      datacenter = \"rayleigh\"\n      data_dir = \"/var/lib/consul\"\n      encrypt = \"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\"\n      ca_file = \"/etc/consul.d/consul-agent-ca.pem\"\n      cert_file = \"/etc/consul.d/dc1-server-consul-0.pem\"\n      key_file = \"/etc/consul.d/dc1-server-consul-0-key.pem\"\n      verify_incoming = true\n      verify_outgoing = true\n      verify_server_hostname = true\n      retry_join = [\"10.10.30.99\",\"10.10.30.100\",\"10.10.30.101\"]\n      performance {\n        raft_multiplier = 1\n      }\n      server = true\n      bootstrap_expect = 3\n      ui = true\n      client_addr = \"0.0.0.0\"\n      advertise_addr = \"10.10.30.99\"\n      auto_encrypt {\n        allow_tls = true\n      }\n  - path: /etc/consul.d/consul-agent-ca.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\n      EwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\n      ZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\n      LjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\n      NzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\n      qaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\n      Fy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\n      AQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\n      BgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\n      hkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\n      XClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIICpjCCAk2gAwIBAgIRAJbMFDcOrU53uJ1JwfhqqI4wCgYIKoZIzj0EAwIwgbkx\n      CzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\n      bzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\n      FQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\n      IDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\n      MTAwMjM2MjBaFw0yMjA4MTAwMjM2MjBaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\n      ZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATBBqg659F2c8+O\n      nViRXCJO0HO420muDIXt9QPpCJX/M/bIyz/IIL7JmBXSGRwcdsEvgUEf0IBJfzWX\n      /j6PDMSJo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\n      AQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgSWw3XvbVNMhNpnSQ\n      8RypjusZaRuTn9fA7KlQ77lV89cwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\n      xNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\n      bnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0cAMEQCIDaHCIcdEJdE\n      UC9F02G/Ydw07nz4/lchTHX8sx14NpKZAiBZ5+ACFFcPM/DbpD0adJPyEwjL/CmY\n      ffCgXfcXrOVrbg==\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0-key.pem\n    content: |\n      -----BEGIN EC PRIVATE KEY-----\n      MHcCAQEEIC6N4oAsZOshX2ldfjeEA3iSYRVBEQKOdrlXFp5geZkHoAoGCCqGSM49\n      AwEHoUQDQgAEwQaoOufRdnPPjp1YkVwiTtBzuNtJrgyF7fUD6QiV/zP2yMs/yCC+\n      yZgV0hkcHHbBL4FBH9CASX81l/4+jwzEiQ==\n      -----END EC PRIVATE KEY-----\n  - path: /etc/systemd/system/consul.service\n    content: |\n      [Unit]\n      Description=\"HashiCorp Consul - A service mesh solution\"\n      Documentation=https://www.consul.io/\n      Requires=network-online.target\n      After=network-online.target\n      ConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n      [Service]\n      Type=notify\n      User=consul\n      Group=consul\n      ExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\n      ExecReload=/bin/kill --signal HUP $MAINPID\n      KillMode=process\n      KillSignal=SIGTERM\n      Restart=on-failure\n      LimitNOFILE=65536\n\n      [Install]\n      WantedBy=multi-user.target\nruncmd:\n  - sudo apt-get update\n  - sudo apt-get install -y zip curl\n  - cd /tmp/\n  - curl -sSL  https://releases.hashicorp.com/consul/1.10.1/consul_1.10.1_linux_amd64.zip \u003e consul.zip\n  - unzip consul.zip\n  - sudo chown consul:consul consul\n  - sudo chmod +x consul\n  - sudo mv consul /usr/local/bin/\n  - rm /tmp/consul.zip\n  - sudo mkdir -p /var/lib/consul\n  - sudo chown -R consul:consul /var/lib/consul\n  - sudo chmod -R 775 /var/lib/consul\n  - sudo systemctl enable consul\n  - sudo systemctl start consul\n",
                "content_type": "text/cloud-config",
                "filename": "",
                "merge_type": "list(append) + dict(no_replace, recurse_list) + str()"
              }
            ],
            "rendered": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\n#cloud-config\nusers:\n  - default\n  - name: ubuntu\n    shell: /bin/bash\n    home: /home/ubuntu\n    lock_passwd: true\n    groups: sudo, users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\nssh_deletekeys: true\nwrite_files:\n  - path: /etc/ssh/trusted-user-ca-keys.pem\n    content: |\n      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n\nbootcmd:\n  - cloud-init-per once ssh-users-ca echo \"TrustedUserCAKeys /etc/ssh/trusted-user-ca-keys.pem\" \u003e\u003e /etc/ssh/sshd_config\npackage_update: true\npackage_upgrade: true\nhostname: consul-server-1\npower_state:\n  timeout: 30\n  mode: reboot\n  message: Restarting\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\nusers:\n  - name: consul\n    system: true\nwrite_files:\n  - path: /etc/consul.d/consul.hcl\n    content: |\n      datacenter = \"rayleigh\"\n      data_dir = \"/var/lib/consul\"\n      encrypt = \"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\"\n      ca_file = \"/etc/consul.d/consul-agent-ca.pem\"\n      cert_file = \"/etc/consul.d/dc1-server-consul-0.pem\"\n      key_file = \"/etc/consul.d/dc1-server-consul-0-key.pem\"\n      verify_incoming = true\n      verify_outgoing = true\n      verify_server_hostname = true\n      retry_join = [\"10.10.30.99\",\"10.10.30.100\",\"10.10.30.101\"]\n      performance {\n        raft_multiplier = 1\n      }\n      server = true\n      bootstrap_expect = 3\n      ui = true\n      client_addr = \"0.0.0.0\"\n      advertise_addr = \"10.10.30.99\"\n      auto_encrypt {\n        allow_tls = true\n      }\n  - path: /etc/consul.d/consul-agent-ca.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\n      EwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\n      ZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\n      LjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\n      NzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\n      qaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\n      Fy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\n      AQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\n      BgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\n      hkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\n      XClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIICpjCCAk2gAwIBAgIRAJbMFDcOrU53uJ1JwfhqqI4wCgYIKoZIzj0EAwIwgbkx\n      CzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\n      bzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\n      FQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\n      IDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\n      MTAwMjM2MjBaFw0yMjA4MTAwMjM2MjBaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\n      ZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATBBqg659F2c8+O\n      nViRXCJO0HO420muDIXt9QPpCJX/M/bIyz/IIL7JmBXSGRwcdsEvgUEf0IBJfzWX\n      /j6PDMSJo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\n      AQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgSWw3XvbVNMhNpnSQ\n      8RypjusZaRuTn9fA7KlQ77lV89cwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\n      xNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\n      bnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0cAMEQCIDaHCIcdEJdE\n      UC9F02G/Ydw07nz4/lchTHX8sx14NpKZAiBZ5+ACFFcPM/DbpD0adJPyEwjL/CmY\n      ffCgXfcXrOVrbg==\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0-key.pem\n    content: |\n      -----BEGIN EC PRIVATE KEY-----\n      MHcCAQEEIC6N4oAsZOshX2ldfjeEA3iSYRVBEQKOdrlXFp5geZkHoAoGCCqGSM49\n      AwEHoUQDQgAEwQaoOufRdnPPjp1YkVwiTtBzuNtJrgyF7fUD6QiV/zP2yMs/yCC+\n      yZgV0hkcHHbBL4FBH9CASX81l/4+jwzEiQ==\n      -----END EC PRIVATE KEY-----\n  - path: /etc/systemd/system/consul.service\n    content: |\n      [Unit]\n      Description=\"HashiCorp Consul - A service mesh solution\"\n      Documentation=https://www.consul.io/\n      Requires=network-online.target\n      After=network-online.target\n      ConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n      [Service]\n      Type=notify\n      User=consul\n      Group=consul\n      ExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\n      ExecReload=/bin/kill --signal HUP $MAINPID\n      KillMode=process\n      KillSignal=SIGTERM\n      Restart=on-failure\n      LimitNOFILE=65536\n\n      [Install]\n      WantedBy=multi-user.target\nruncmd:\n  - sudo apt-get update\n  - sudo apt-get install -y zip curl\n  - cd /tmp/\n  - curl -sSL  https://releases.hashicorp.com/consul/1.10.1/consul_1.10.1_linux_amd64.zip \u003e consul.zip\n  - unzip consul.zip\n  - sudo chown consul:consul consul\n  - sudo chmod +x consul\n  - sudo mv consul /usr/local/bin/\n  - rm /tmp/consul.zip\n  - sudo mkdir -p /var/lib/consul\n  - sudo chown -R consul:consul /var/lib/consul\n  - sudo chmod -R 775 /var/lib/consul\n  - sudo systemctl enable consul\n  - sudo systemctl start consul\n\r\n--MIMEBOUNDARY--\r\n"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "part"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "content"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "part"
              },
              {
                "type": "index",
                "value": {
                  "value": 1,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "content"
              }
            ]
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[0].module.cloud-init-vm",
      "mode": "data",
      "type": "vault_generic_secret",
      "name": "proxmox_node_settings",
      "provider": "provider[\"registry.terraform.io/hashicorp/vault\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "data": {
              "host": "10.10.30.168",
              "password": "Forever!6+7",
              "storage": "local-zfs",
              "username": "root"
            },
            "data_json": "{\"host\":\"10.10.30.168\",\"password\":\"Forever!6+7\",\"storage\":\"local-zfs\",\"username\":\"root\"}",
            "id": "secret/home/proxmox/avalon",
            "lease_duration": 0,
            "lease_id": "",
            "lease_renewable": false,
            "lease_start_time": "RFC2229",
            "path": "secret/home/proxmox/avalon",
            "version": -1
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "path"
              }
            ]
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[0].module.cloud-init-vm",
      "mode": "managed",
      "type": "null_resource",
      "name": "cloud_init_config_files",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "7867387467648131952",
            "triggers": {
              "file_content": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\n#cloud-config\nusers:\n  - default\n  - name: ubuntu\n    shell: /bin/bash\n    home: /home/ubuntu\n    lock_passwd: true\n    groups: sudo, users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\nssh_deletekeys: true\nwrite_files:\n  - path: /etc/ssh/trusted-user-ca-keys.pem\n    content: |\n      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n\nbootcmd:\n  - cloud-init-per once ssh-users-ca echo \"TrustedUserCAKeys /etc/ssh/trusted-user-ca-keys.pem\" \u003e\u003e /etc/ssh/sshd_config\npackage_update: true\npackage_upgrade: true\nhostname: consul-server-1\npower_state:\n  timeout: 30\n  mode: reboot\n  message: Restarting\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\nusers:\n  - name: consul\n    system: true\nwrite_files:\n  - path: /etc/consul.d/consul.hcl\n    content: |\n      datacenter = \"rayleigh\"\n      data_dir = \"/var/lib/consul\"\n      encrypt = \"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\"\n      ca_file = \"/etc/consul.d/consul-agent-ca.pem\"\n      cert_file = \"/etc/consul.d/dc1-server-consul-0.pem\"\n      key_file = \"/etc/consul.d/dc1-server-consul-0-key.pem\"\n      verify_incoming = true\n      verify_outgoing = true\n      verify_server_hostname = true\n      retry_join = [\"10.10.30.99\",\"10.10.30.100\",\"10.10.30.101\"]\n      performance {\n        raft_multiplier = 1\n      }\n      server = true\n      bootstrap_expect = 3\n      ui = true\n      client_addr = \"0.0.0.0\"\n      advertise_addr = \"10.10.30.99\"\n      auto_encrypt {\n        allow_tls = true\n      }\n  - path: /etc/consul.d/consul-agent-ca.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\n      EwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\n      ZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\n      LjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\n      NzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\n      qaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\n      Fy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\n      AQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\n      BgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\n      hkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\n      XClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIICpjCCAk2gAwIBAgIRAJbMFDcOrU53uJ1JwfhqqI4wCgYIKoZIzj0EAwIwgbkx\n      CzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\n      bzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\n      FQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\n      IDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\n      MTAwMjM2MjBaFw0yMjA4MTAwMjM2MjBaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\n      ZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATBBqg659F2c8+O\n      nViRXCJO0HO420muDIXt9QPpCJX/M/bIyz/IIL7JmBXSGRwcdsEvgUEf0IBJfzWX\n      /j6PDMSJo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\n      AQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgSWw3XvbVNMhNpnSQ\n      8RypjusZaRuTn9fA7KlQ77lV89cwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\n      xNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\n      bnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0cAMEQCIDaHCIcdEJdE\n      UC9F02G/Ydw07nz4/lchTHX8sx14NpKZAiBZ5+ACFFcPM/DbpD0adJPyEwjL/CmY\n      ffCgXfcXrOVrbg==\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0-key.pem\n    content: |\n      -----BEGIN EC PRIVATE KEY-----\n      MHcCAQEEIC6N4oAsZOshX2ldfjeEA3iSYRVBEQKOdrlXFp5geZkHoAoGCCqGSM49\n      AwEHoUQDQgAEwQaoOufRdnPPjp1YkVwiTtBzuNtJrgyF7fUD6QiV/zP2yMs/yCC+\n      yZgV0hkcHHbBL4FBH9CASX81l/4+jwzEiQ==\n      -----END EC PRIVATE KEY-----\n  - path: /etc/systemd/system/consul.service\n    content: |\n      [Unit]\n      Description=\"HashiCorp Consul - A service mesh solution\"\n      Documentation=https://www.consul.io/\n      Requires=network-online.target\n      After=network-online.target\n      ConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n      [Service]\n      Type=notify\n      User=consul\n      Group=consul\n      ExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\n      ExecReload=/bin/kill --signal HUP $MAINPID\n      KillMode=process\n      KillSignal=SIGTERM\n      Restart=on-failure\n      LimitNOFILE=65536\n\n      [Install]\n      WantedBy=multi-user.target\nruncmd:\n  - sudo apt-get update\n  - sudo apt-get install -y zip curl\n  - cd /tmp/\n  - curl -sSL  https://releases.hashicorp.com/consul/1.10.1/consul_1.10.1_linux_amd64.zip \u003e consul.zip\n  - unzip consul.zip\n  - sudo chown consul:consul consul\n  - sudo chmod +x consul\n  - sudo mv consul /usr/local/bin/\n  - rm /tmp/consul.zip\n  - sudo mkdir -p /var/lib/consul\n  - sudo chown -R consul:consul /var/lib/consul\n  - sudo chmod -R 775 /var/lib/consul\n  - sudo systemctl enable consul\n  - sudo systemctl start consul\n\r\n--MIMEBOUNDARY--\r\n"
            }
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "triggers"
              },
              {
                "type": "index",
                "value": {
                  "value": "file_content",
                  "type": "string"
                }
              }
            ]
          ],
          "private": "bnVsbA==",
          "dependencies": [
            "data.consul_keys.config",
            "module.local_vault.vault_mount.vm-client-signer",
            "module.local_vault.vault_ssh_secret_backend_ca.ca",
            "module.local_vault.vault_ssh_secret_backend_role.mac",
            "module.proxmox.data.vault_generic_secret.consul_config",
            "module.proxmox.module.consul_server.data.cloudinit_config.config",
            "module.proxmox.module.consul_server.module.cloud-init-vm.data.vault_generic_secret.proxmox_node_settings"
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[0].module.cloud-init-vm",
      "mode": "managed",
      "type": "proxmox_vm_qemu",
      "name": "cloud-init-server",
      "provider": "provider[\"registry.terraform.io/telmate/proxmox\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "additional_wait": 15,
            "agent": 0,
            "args": "",
            "balloon": 0,
            "bios": "seabios",
            "boot": "cdn",
            "bootdisk": "scsi0",
            "bridge": "",
            "ci_wait": null,
            "cicustom": "user=images:snippets/cloud-init-consul-server-1.yml",
            "cipassword": "",
            "ciuser": "",
            "clone": "ubuntu-cloudinit",
            "clone_wait": 15,
            "cloudinit_cdrom_storage": "local-zfs",
            "cores": 1,
            "cpu": "host",
            "default_ipv4_address": "",
            "define_connection_info": true,
            "desc": "",
            "disk": [
              {
                "backup": 0,
                "cache": "none",
                "discard": "",
                "file": "vm-106-disk-0",
                "format": "raw",
                "iothread": 1,
                "mbps": 0,
                "mbps_rd": 0,
                "mbps_rd_max": 0,
                "mbps_wr": 0,
                "mbps_wr_max": 0,
                "media": "",
                "replicate": 0,
                "size": "20G",
                "slot": 0,
                "ssd": 0,
                "storage": "local-zfs",
                "storage_type": "zfspool",
                "type": "scsi",
                "volume": "local-zfs:vm-106-disk-0"
              }
            ],
            "disk_gb": 0,
            "force_create": false,
            "force_recreate_on_change_of": null,
            "full_clone": true,
            "guest_agent_ready_timeout": 120,
            "hastate": "",
            "hotplug": "network,disk,usb",
            "id": "avalon/qemu/106",
            "ipconfig0": "ip=10.10.30.99/24,gw=10.10.30.1",
            "ipconfig1": "",
            "ipconfig2": "",
            "iso": null,
            "kvm": true,
            "mac": "",
            "memory": 1024,
            "name": "consul-server-1",
            "nameserver": "",
            "network": [
              {
                "bridge": "vmbr0",
                "firewall": false,
                "link_down": false,
                "macaddr": "42:22:AA:DB:7F:30",
                "model": "virtio",
                "queues": 0,
                "rate": 0,
                "tag": -1
              }
            ],
            "nic": "",
            "numa": false,
            "onboot": true,
            "os_network_config": null,
            "os_type": "cloud-init",
            "pool": "",
            "preprovision": true,
            "qemu_os": "other",
            "reboot_required": false,
            "scsihw": "virtio-scsi-pci",
            "searchdomain": "",
            "serial": [],
            "sockets": 1,
            "ssh_forward_ip": null,
            "ssh_host": "10.10.30.99",
            "ssh_port": "22",
            "ssh_private_key": null,
            "ssh_user": null,
            "sshkeys": "",
            "storage": "",
            "storage_type": "",
            "tags": "",
            "target_node": "avalon",
            "unused_disk": [],
            "vcpus": 0,
            "vga": [],
            "vlan": -1,
            "vmid": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "cloudinit_cdrom_storage"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "disk"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "storage"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "ipconfig0"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "target_node"
              }
            ]
          ],
          "private": "bnVsbA==",
          "dependencies": [
            "module.proxmox.module.consul_server.module.cloud-init-vm.data.vault_generic_secret.proxmox_node_settings",
            "data.consul_keys.config",
            "data.vault_generic_secret.proxmox_credentials",
            "module.local_vault.vault_mount.vm-client-signer",
            "module.local_vault.vault_ssh_secret_backend_ca.ca",
            "module.local_vault.vault_ssh_secret_backend_role.mac",
            "module.proxmox.data.vault_generic_secret.consul_config"
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[1]",
      "mode": "data",
      "type": "cloudinit_config",
      "name": "config",
      "provider": "provider[\"registry.terraform.io/hashicorp/cloudinit\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base64_encode": false,
            "boundary": "MIMEBOUNDARY",
            "gzip": false,
            "id": "1534493908",
            "part": [
              {
                "content": "#cloud-config\nusers:\n  - default\n  - name: ubuntu\n    shell: /bin/bash\n    home: /home/ubuntu\n    lock_passwd: true\n    groups: sudo, users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\nssh_deletekeys: true\nwrite_files:\n  - path: /etc/ssh/trusted-user-ca-keys.pem\n    content: |\n      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n\nbootcmd:\n  - cloud-init-per once ssh-users-ca echo \"TrustedUserCAKeys /etc/ssh/trusted-user-ca-keys.pem\" \u003e\u003e /etc/ssh/sshd_config\npackage_update: true\npackage_upgrade: true\nhostname: consul-server-2\npower_state:\n  timeout: 30\n  mode: reboot\n  message: Restarting",
                "content_type": "text/cloud-config",
                "filename": "",
                "merge_type": "list(append) + dict(no_replace, recurse_list) + str()"
              },
              {
                "content": "users:\n  - name: consul\n    system: true\nwrite_files:\n  - path: /etc/consul.d/consul.hcl\n    content: |\n      datacenter = \"rayleigh\"\n      data_dir = \"/var/lib/consul\"\n      encrypt = \"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\"\n      ca_file = \"/etc/consul.d/consul-agent-ca.pem\"\n      cert_file = \"/etc/consul.d/dc1-server-consul-0.pem\"\n      key_file = \"/etc/consul.d/dc1-server-consul-0-key.pem\"\n      verify_incoming = true\n      verify_outgoing = true\n      verify_server_hostname = true\n      retry_join = [\"10.10.30.99\",\"10.10.30.100\",\"10.10.30.101\"]\n      performance {\n        raft_multiplier = 1\n      }\n      server = true\n      bootstrap_expect = 3\n      ui = true\n      client_addr = \"0.0.0.0\"\n      advertise_addr = \"10.10.30.100\"\n      auto_encrypt {\n        allow_tls = true\n      }\n  - path: /etc/consul.d/consul-agent-ca.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\n      EwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\n      ZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\n      LjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\n      NzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\n      qaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\n      Fy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\n      AQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\n      BgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\n      hkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\n      XClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIICpzCCAkygAwIBAgIQPDZwz2G8laEsCqDqPfTvUzAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzcwNloXDTIyMDgxMDAyMzcwNlowITEfMB0GA1UEAxMWc2VydmVyLnJheWxl\n      aWdoLmNvbnN1bDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJGVbDsQ5pi+xQNy\n      gjSuzeMZ9XI8x3VM/JHUs29AHJmCr9gamIdFURADcm9LNxq5yGTjEcu1dWVpfgal\n      esPjLq6jgcwwgckwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMB\n      BggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMCkGA1UdDgQiBCBBWCLuozz/wcv63Sl+\n      HuBVMml8JEUkFYzT/QrakzDY9TArBgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE\n      2L7mFiV93a2lC1aP6xJc3zAyBgNVHREEKzApghZzZXJ2ZXIucmF5bGVpZ2guY29u\n      c3Vsgglsb2NhbGhvc3SHBH8AAAEwCgYIKoZIzj0EAwIDSQAwRgIhAPi4Lm4x4OO5\n      OEBbeFX0jxwkkhF04kikCpuAMqH0qQfpAiEAy0/OY0vE6mP0T+KH1mSfNDEbTh6I\n      0VJzjqMmQ1Fbzi8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0-key.pem\n    content: |\n      -----BEGIN EC PRIVATE KEY-----\n      MHcCAQEEICm+QSgr0qJG0C4kKKwEXLmaa8A6Jd8nGB9tZoIygesYoAoGCCqGSM49\n      AwEHoUQDQgAEkZVsOxDmmL7FA3KCNK7N4xn1cjzHdUz8kdSzb0AcmYKv2BqYh0VR\n      EANyb0s3GrnIZOMRy7V1ZWl+BqV6w+Murg==\n      -----END EC PRIVATE KEY-----\n  - path: /etc/systemd/system/consul.service\n    content: |\n      [Unit]\n      Description=\"HashiCorp Consul - A service mesh solution\"\n      Documentation=https://www.consul.io/\n      Requires=network-online.target\n      After=network-online.target\n      ConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n      [Service]\n      Type=notify\n      User=consul\n      Group=consul\n      ExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\n      ExecReload=/bin/kill --signal HUP $MAINPID\n      KillMode=process\n      KillSignal=SIGTERM\n      Restart=on-failure\n      LimitNOFILE=65536\n\n      [Install]\n      WantedBy=multi-user.target\nruncmd:\n  - sudo apt-get update\n  - sudo apt-get install -y zip curl\n  - cd /tmp/\n  - curl -sSL  https://releases.hashicorp.com/consul/1.10.1/consul_1.10.1_linux_amd64.zip \u003e consul.zip\n  - unzip consul.zip\n  - sudo chown consul:consul consul\n  - sudo chmod +x consul\n  - sudo mv consul /usr/local/bin/\n  - rm /tmp/consul.zip\n  - sudo mkdir -p /var/lib/consul\n  - sudo chown -R consul:consul /var/lib/consul\n  - sudo chmod -R 775 /var/lib/consul\n  - sudo systemctl enable consul\n  - sudo systemctl start consul\n",
                "content_type": "text/cloud-config",
                "filename": "",
                "merge_type": "list(append) + dict(no_replace, recurse_list) + str()"
              }
            ],
            "rendered": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\n#cloud-config\nusers:\n  - default\n  - name: ubuntu\n    shell: /bin/bash\n    home: /home/ubuntu\n    lock_passwd: true\n    groups: sudo, users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\nssh_deletekeys: true\nwrite_files:\n  - path: /etc/ssh/trusted-user-ca-keys.pem\n    content: |\n      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n\nbootcmd:\n  - cloud-init-per once ssh-users-ca echo \"TrustedUserCAKeys /etc/ssh/trusted-user-ca-keys.pem\" \u003e\u003e /etc/ssh/sshd_config\npackage_update: true\npackage_upgrade: true\nhostname: consul-server-2\npower_state:\n  timeout: 30\n  mode: reboot\n  message: Restarting\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\nusers:\n  - name: consul\n    system: true\nwrite_files:\n  - path: /etc/consul.d/consul.hcl\n    content: |\n      datacenter = \"rayleigh\"\n      data_dir = \"/var/lib/consul\"\n      encrypt = \"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\"\n      ca_file = \"/etc/consul.d/consul-agent-ca.pem\"\n      cert_file = \"/etc/consul.d/dc1-server-consul-0.pem\"\n      key_file = \"/etc/consul.d/dc1-server-consul-0-key.pem\"\n      verify_incoming = true\n      verify_outgoing = true\n      verify_server_hostname = true\n      retry_join = [\"10.10.30.99\",\"10.10.30.100\",\"10.10.30.101\"]\n      performance {\n        raft_multiplier = 1\n      }\n      server = true\n      bootstrap_expect = 3\n      ui = true\n      client_addr = \"0.0.0.0\"\n      advertise_addr = \"10.10.30.100\"\n      auto_encrypt {\n        allow_tls = true\n      }\n  - path: /etc/consul.d/consul-agent-ca.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\n      EwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\n      ZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\n      LjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\n      NzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\n      qaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\n      Fy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\n      AQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\n      BgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\n      hkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\n      XClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIICpzCCAkygAwIBAgIQPDZwz2G8laEsCqDqPfTvUzAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzcwNloXDTIyMDgxMDAyMzcwNlowITEfMB0GA1UEAxMWc2VydmVyLnJheWxl\n      aWdoLmNvbnN1bDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJGVbDsQ5pi+xQNy\n      gjSuzeMZ9XI8x3VM/JHUs29AHJmCr9gamIdFURADcm9LNxq5yGTjEcu1dWVpfgal\n      esPjLq6jgcwwgckwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMB\n      BggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMCkGA1UdDgQiBCBBWCLuozz/wcv63Sl+\n      HuBVMml8JEUkFYzT/QrakzDY9TArBgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE\n      2L7mFiV93a2lC1aP6xJc3zAyBgNVHREEKzApghZzZXJ2ZXIucmF5bGVpZ2guY29u\n      c3Vsgglsb2NhbGhvc3SHBH8AAAEwCgYIKoZIzj0EAwIDSQAwRgIhAPi4Lm4x4OO5\n      OEBbeFX0jxwkkhF04kikCpuAMqH0qQfpAiEAy0/OY0vE6mP0T+KH1mSfNDEbTh6I\n      0VJzjqMmQ1Fbzi8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0-key.pem\n    content: |\n      -----BEGIN EC PRIVATE KEY-----\n      MHcCAQEEICm+QSgr0qJG0C4kKKwEXLmaa8A6Jd8nGB9tZoIygesYoAoGCCqGSM49\n      AwEHoUQDQgAEkZVsOxDmmL7FA3KCNK7N4xn1cjzHdUz8kdSzb0AcmYKv2BqYh0VR\n      EANyb0s3GrnIZOMRy7V1ZWl+BqV6w+Murg==\n      -----END EC PRIVATE KEY-----\n  - path: /etc/systemd/system/consul.service\n    content: |\n      [Unit]\n      Description=\"HashiCorp Consul - A service mesh solution\"\n      Documentation=https://www.consul.io/\n      Requires=network-online.target\n      After=network-online.target\n      ConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n      [Service]\n      Type=notify\n      User=consul\n      Group=consul\n      ExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\n      ExecReload=/bin/kill --signal HUP $MAINPID\n      KillMode=process\n      KillSignal=SIGTERM\n      Restart=on-failure\n      LimitNOFILE=65536\n\n      [Install]\n      WantedBy=multi-user.target\nruncmd:\n  - sudo apt-get update\n  - sudo apt-get install -y zip curl\n  - cd /tmp/\n  - curl -sSL  https://releases.hashicorp.com/consul/1.10.1/consul_1.10.1_linux_amd64.zip \u003e consul.zip\n  - unzip consul.zip\n  - sudo chown consul:consul consul\n  - sudo chmod +x consul\n  - sudo mv consul /usr/local/bin/\n  - rm /tmp/consul.zip\n  - sudo mkdir -p /var/lib/consul\n  - sudo chown -R consul:consul /var/lib/consul\n  - sudo chmod -R 775 /var/lib/consul\n  - sudo systemctl enable consul\n  - sudo systemctl start consul\n\r\n--MIMEBOUNDARY--\r\n"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "part"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "content"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "part"
              },
              {
                "type": "index",
                "value": {
                  "value": 1,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "content"
              }
            ]
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[1].module.cloud-init-vm",
      "mode": "data",
      "type": "vault_generic_secret",
      "name": "proxmox_node_settings",
      "provider": "provider[\"registry.terraform.io/hashicorp/vault\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "data": {
              "host": "10.10.30.97",
              "password": "Forever!6+7",
              "storage": "skypiea-zfs",
              "username": "root"
            },
            "data_json": "{\"host\":\"10.10.30.97\",\"password\":\"Forever!6+7\",\"storage\":\"skypiea-zfs\",\"username\":\"root\"}",
            "id": "secret/home/proxmox/skypiea",
            "lease_duration": 0,
            "lease_id": "",
            "lease_renewable": false,
            "lease_start_time": "RFC2229",
            "path": "secret/home/proxmox/skypiea",
            "version": -1
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "path"
              }
            ]
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[1].module.cloud-init-vm",
      "mode": "managed",
      "type": "null_resource",
      "name": "cloud_init_config_files",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "3521622573930968492",
            "triggers": {
              "file_content": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\n#cloud-config\nusers:\n  - default\n  - name: ubuntu\n    shell: /bin/bash\n    home: /home/ubuntu\n    lock_passwd: true\n    groups: sudo, users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\nssh_deletekeys: true\nwrite_files:\n  - path: /etc/ssh/trusted-user-ca-keys.pem\n    content: |\n      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n\nbootcmd:\n  - cloud-init-per once ssh-users-ca echo \"TrustedUserCAKeys /etc/ssh/trusted-user-ca-keys.pem\" \u003e\u003e /etc/ssh/sshd_config\npackage_update: true\npackage_upgrade: true\nhostname: consul-server-2\npower_state:\n  timeout: 30\n  mode: reboot\n  message: Restarting\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\nusers:\n  - name: consul\n    system: true\nwrite_files:\n  - path: /etc/consul.d/consul.hcl\n    content: |\n      datacenter = \"rayleigh\"\n      data_dir = \"/var/lib/consul\"\n      encrypt = \"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\"\n      ca_file = \"/etc/consul.d/consul-agent-ca.pem\"\n      cert_file = \"/etc/consul.d/dc1-server-consul-0.pem\"\n      key_file = \"/etc/consul.d/dc1-server-consul-0-key.pem\"\n      verify_incoming = true\n      verify_outgoing = true\n      verify_server_hostname = true\n      retry_join = [\"10.10.30.99\",\"10.10.30.100\",\"10.10.30.101\"]\n      performance {\n        raft_multiplier = 1\n      }\n      server = true\n      bootstrap_expect = 3\n      ui = true\n      client_addr = \"0.0.0.0\"\n      advertise_addr = \"10.10.30.100\"\n      auto_encrypt {\n        allow_tls = true\n      }\n  - path: /etc/consul.d/consul-agent-ca.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\n      EwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\n      ZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\n      LjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\n      NzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\n      qaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\n      Fy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\n      AQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\n      BgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\n      hkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\n      XClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIICpzCCAkygAwIBAgIQPDZwz2G8laEsCqDqPfTvUzAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzcwNloXDTIyMDgxMDAyMzcwNlowITEfMB0GA1UEAxMWc2VydmVyLnJheWxl\n      aWdoLmNvbnN1bDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJGVbDsQ5pi+xQNy\n      gjSuzeMZ9XI8x3VM/JHUs29AHJmCr9gamIdFURADcm9LNxq5yGTjEcu1dWVpfgal\n      esPjLq6jgcwwgckwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMB\n      BggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMCkGA1UdDgQiBCBBWCLuozz/wcv63Sl+\n      HuBVMml8JEUkFYzT/QrakzDY9TArBgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE\n      2L7mFiV93a2lC1aP6xJc3zAyBgNVHREEKzApghZzZXJ2ZXIucmF5bGVpZ2guY29u\n      c3Vsgglsb2NhbGhvc3SHBH8AAAEwCgYIKoZIzj0EAwIDSQAwRgIhAPi4Lm4x4OO5\n      OEBbeFX0jxwkkhF04kikCpuAMqH0qQfpAiEAy0/OY0vE6mP0T+KH1mSfNDEbTh6I\n      0VJzjqMmQ1Fbzi8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0-key.pem\n    content: |\n      -----BEGIN EC PRIVATE KEY-----\n      MHcCAQEEICm+QSgr0qJG0C4kKKwEXLmaa8A6Jd8nGB9tZoIygesYoAoGCCqGSM49\n      AwEHoUQDQgAEkZVsOxDmmL7FA3KCNK7N4xn1cjzHdUz8kdSzb0AcmYKv2BqYh0VR\n      EANyb0s3GrnIZOMRy7V1ZWl+BqV6w+Murg==\n      -----END EC PRIVATE KEY-----\n  - path: /etc/systemd/system/consul.service\n    content: |\n      [Unit]\n      Description=\"HashiCorp Consul - A service mesh solution\"\n      Documentation=https://www.consul.io/\n      Requires=network-online.target\n      After=network-online.target\n      ConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n      [Service]\n      Type=notify\n      User=consul\n      Group=consul\n      ExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\n      ExecReload=/bin/kill --signal HUP $MAINPID\n      KillMode=process\n      KillSignal=SIGTERM\n      Restart=on-failure\n      LimitNOFILE=65536\n\n      [Install]\n      WantedBy=multi-user.target\nruncmd:\n  - sudo apt-get update\n  - sudo apt-get install -y zip curl\n  - cd /tmp/\n  - curl -sSL  https://releases.hashicorp.com/consul/1.10.1/consul_1.10.1_linux_amd64.zip \u003e consul.zip\n  - unzip consul.zip\n  - sudo chown consul:consul consul\n  - sudo chmod +x consul\n  - sudo mv consul /usr/local/bin/\n  - rm /tmp/consul.zip\n  - sudo mkdir -p /var/lib/consul\n  - sudo chown -R consul:consul /var/lib/consul\n  - sudo chmod -R 775 /var/lib/consul\n  - sudo systemctl enable consul\n  - sudo systemctl start consul\n\r\n--MIMEBOUNDARY--\r\n"
            }
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "triggers"
              },
              {
                "type": "index",
                "value": {
                  "value": "file_content",
                  "type": "string"
                }
              }
            ]
          ],
          "private": "bnVsbA==",
          "dependencies": [
            "module.local_vault.vault_ssh_secret_backend_ca.ca",
            "module.local_vault.vault_ssh_secret_backend_role.mac",
            "module.proxmox.data.vault_generic_secret.consul_config",
            "module.proxmox.module.consul_server.data.cloudinit_config.config",
            "module.proxmox.module.consul_server.module.cloud-init-vm.data.vault_generic_secret.proxmox_node_settings",
            "data.consul_keys.config",
            "module.local_vault.vault_mount.vm-client-signer"
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[1].module.cloud-init-vm",
      "mode": "managed",
      "type": "proxmox_vm_qemu",
      "name": "cloud-init-server",
      "provider": "provider[\"registry.terraform.io/telmate/proxmox\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "additional_wait": 15,
            "agent": 0,
            "args": "",
            "balloon": 0,
            "bios": "seabios",
            "boot": "cdn",
            "bootdisk": "scsi0",
            "bridge": "",
            "ci_wait": null,
            "cicustom": "user=images:snippets/cloud-init-consul-server-2.yml",
            "cipassword": "",
            "ciuser": "",
            "clone": "ubuntu-cloudinit",
            "clone_wait": 15,
            "cloudinit_cdrom_storage": "skypiea-zfs",
            "cores": 1,
            "cpu": "host",
            "default_ipv4_address": "",
            "define_connection_info": true,
            "desc": "",
            "disk": [
              {
                "backup": 0,
                "cache": "none",
                "discard": "",
                "file": "vm-107-disk-0",
                "format": "raw",
                "iothread": 1,
                "mbps": 0,
                "mbps_rd": 0,
                "mbps_rd_max": 0,
                "mbps_wr": 0,
                "mbps_wr_max": 0,
                "media": "",
                "replicate": 0,
                "size": "20G",
                "slot": 0,
                "ssd": 0,
                "storage": "skypiea-zfs",
                "storage_type": "zfspool",
                "type": "scsi",
                "volume": "skypiea-zfs:vm-107-disk-0"
              }
            ],
            "disk_gb": 0,
            "force_create": false,
            "force_recreate_on_change_of": null,
            "full_clone": true,
            "guest_agent_ready_timeout": 120,
            "hastate": "",
            "hotplug": "network,disk,usb",
            "id": "skypiea/qemu/107",
            "ipconfig0": "ip=10.10.30.100/24,gw=10.10.30.1",
            "ipconfig1": "",
            "ipconfig2": "",
            "iso": null,
            "kvm": true,
            "mac": "",
            "memory": 1024,
            "name": "consul-server-2",
            "nameserver": "",
            "network": [
              {
                "bridge": "vmbr0",
                "firewall": false,
                "link_down": false,
                "macaddr": "52:9A:D9:9C:8A:3B",
                "model": "virtio",
                "queues": 0,
                "rate": 0,
                "tag": -1
              }
            ],
            "nic": "",
            "numa": false,
            "onboot": true,
            "os_network_config": null,
            "os_type": "cloud-init",
            "pool": "",
            "preprovision": true,
            "qemu_os": "other",
            "reboot_required": false,
            "scsihw": "virtio-scsi-pci",
            "searchdomain": "",
            "serial": [],
            "sockets": 1,
            "ssh_forward_ip": null,
            "ssh_host": "10.10.30.100",
            "ssh_port": "22",
            "ssh_private_key": null,
            "ssh_user": null,
            "sshkeys": "",
            "storage": "",
            "storage_type": "",
            "tags": "",
            "target_node": "skypiea",
            "unused_disk": [],
            "vcpus": 0,
            "vga": [],
            "vlan": -1,
            "vmid": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "cloudinit_cdrom_storage"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "target_node"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "ipconfig0"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "disk"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "storage"
              }
            ]
          ],
          "private": "bnVsbA==",
          "dependencies": [
            "data.vault_generic_secret.proxmox_credentials",
            "module.local_vault.vault_mount.vm-client-signer",
            "module.local_vault.vault_ssh_secret_backend_ca.ca",
            "module.local_vault.vault_ssh_secret_backend_role.mac",
            "module.proxmox.data.vault_generic_secret.consul_config",
            "module.proxmox.module.consul_server.module.cloud-init-vm.data.vault_generic_secret.proxmox_node_settings",
            "data.consul_keys.config"
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[2]",
      "mode": "data",
      "type": "cloudinit_config",
      "name": "config",
      "provider": "provider[\"registry.terraform.io/hashicorp/cloudinit\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base64_encode": false,
            "boundary": "MIMEBOUNDARY",
            "gzip": false,
            "id": "1244177109",
            "part": [
              {
                "content": "#cloud-config\nusers:\n  - default\n  - name: ubuntu\n    shell: /bin/bash\n    home: /home/ubuntu\n    lock_passwd: true\n    groups: sudo, users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\nssh_deletekeys: true\nwrite_files:\n  - path: /etc/ssh/trusted-user-ca-keys.pem\n    content: |\n      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n\nbootcmd:\n  - cloud-init-per once ssh-users-ca echo \"TrustedUserCAKeys /etc/ssh/trusted-user-ca-keys.pem\" \u003e\u003e /etc/ssh/sshd_config\npackage_update: true\npackage_upgrade: true\nhostname: consul-server-3\npower_state:\n  timeout: 30\n  mode: reboot\n  message: Restarting",
                "content_type": "text/cloud-config",
                "filename": "",
                "merge_type": "list(append) + dict(no_replace, recurse_list) + str()"
              },
              {
                "content": "users:\n  - name: consul\n    system: true\nwrite_files:\n  - path: /etc/consul.d/consul.hcl\n    content: |\n      datacenter = \"rayleigh\"\n      data_dir = \"/var/lib/consul\"\n      encrypt = \"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\"\n      ca_file = \"/etc/consul.d/consul-agent-ca.pem\"\n      cert_file = \"/etc/consul.d/dc1-server-consul-0.pem\"\n      key_file = \"/etc/consul.d/dc1-server-consul-0-key.pem\"\n      verify_incoming = true\n      verify_outgoing = true\n      verify_server_hostname = true\n      retry_join = [\"10.10.30.99\",\"10.10.30.100\",\"10.10.30.101\"]\n      performance {\n        raft_multiplier = 1\n      }\n      server = true\n      bootstrap_expect = 3\n      ui = true\n      client_addr = \"0.0.0.0\"\n      advertise_addr = \"10.10.30.101\"\n      auto_encrypt {\n        allow_tls = true\n      }\n  - path: /etc/consul.d/consul-agent-ca.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\n      EwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\n      ZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\n      LjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\n      NzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\n      qaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\n      Fy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\n      AQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\n      BgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\n      hkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\n      XClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIICqDCCAk2gAwIBAgIRAM+wX1p9xL9Y5QgSMPdoCWQwCgYIKoZIzj0EAwIwgbkx\n      CzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\n      bzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\n      FQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\n      IDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\n      MTAwMjM3MDdaFw0yMjA4MTAwMjM3MDdaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\n      ZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASLUQdY9KOz/76D\n      hpue/erFWF6Om7uFLncy8hCz00KaSTB412ElNIBtT59ftUPsu75I7YnlJ4Kf8qo4\n      N3uw+WzCo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\n      AQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgQxlyuL8KQd9Mwj3M\n      u1x9D4wO7pWeU+IublKxSoZ6CpAwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\n      xNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\n      bnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0kAMEYCIQCYBeSJ3WOv\n      WO/jrdOIo1vKMomDfVZ8Hh1w9n/t8+ziBwIhALQJbGsxv96gKfEmcxh624syGXBC\n      skzUwQf5XNYARQaV\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0-key.pem\n    content: |\n      -----BEGIN EC PRIVATE KEY-----\n      MHcCAQEEIC5ByiRFJaGg4eU4F7PPhspehHDDzwrKu0IfJevvUqQroAoGCCqGSM49\n      AwEHoUQDQgAEi1EHWPSjs/++g4abnv3qxVhejpu7hS53MvIQs9NCmkkweNdhJTSA\n      bU+fX7VD7Lu+SO2J5SeCn/KqODd7sPlswg==\n      -----END EC PRIVATE KEY-----\n  - path: /etc/systemd/system/consul.service\n    content: |\n      [Unit]\n      Description=\"HashiCorp Consul - A service mesh solution\"\n      Documentation=https://www.consul.io/\n      Requires=network-online.target\n      After=network-online.target\n      ConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n      [Service]\n      Type=notify\n      User=consul\n      Group=consul\n      ExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\n      ExecReload=/bin/kill --signal HUP $MAINPID\n      KillMode=process\n      KillSignal=SIGTERM\n      Restart=on-failure\n      LimitNOFILE=65536\n\n      [Install]\n      WantedBy=multi-user.target\nruncmd:\n  - sudo apt-get update\n  - sudo apt-get install -y zip curl\n  - cd /tmp/\n  - curl -sSL  https://releases.hashicorp.com/consul/1.10.1/consul_1.10.1_linux_amd64.zip \u003e consul.zip\n  - unzip consul.zip\n  - sudo chown consul:consul consul\n  - sudo chmod +x consul\n  - sudo mv consul /usr/local/bin/\n  - rm /tmp/consul.zip\n  - sudo mkdir -p /var/lib/consul\n  - sudo chown -R consul:consul /var/lib/consul\n  - sudo chmod -R 775 /var/lib/consul\n  - sudo systemctl enable consul\n  - sudo systemctl start consul\n",
                "content_type": "text/cloud-config",
                "filename": "",
                "merge_type": "list(append) + dict(no_replace, recurse_list) + str()"
              }
            ],
            "rendered": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\n#cloud-config\nusers:\n  - default\n  - name: ubuntu\n    shell: /bin/bash\n    home: /home/ubuntu\n    lock_passwd: true\n    groups: sudo, users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\nssh_deletekeys: true\nwrite_files:\n  - path: /etc/ssh/trusted-user-ca-keys.pem\n    content: |\n      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n\nbootcmd:\n  - cloud-init-per once ssh-users-ca echo \"TrustedUserCAKeys /etc/ssh/trusted-user-ca-keys.pem\" \u003e\u003e /etc/ssh/sshd_config\npackage_update: true\npackage_upgrade: true\nhostname: consul-server-3\npower_state:\n  timeout: 30\n  mode: reboot\n  message: Restarting\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\nusers:\n  - name: consul\n    system: true\nwrite_files:\n  - path: /etc/consul.d/consul.hcl\n    content: |\n      datacenter = \"rayleigh\"\n      data_dir = \"/var/lib/consul\"\n      encrypt = \"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\"\n      ca_file = \"/etc/consul.d/consul-agent-ca.pem\"\n      cert_file = \"/etc/consul.d/dc1-server-consul-0.pem\"\n      key_file = \"/etc/consul.d/dc1-server-consul-0-key.pem\"\n      verify_incoming = true\n      verify_outgoing = true\n      verify_server_hostname = true\n      retry_join = [\"10.10.30.99\",\"10.10.30.100\",\"10.10.30.101\"]\n      performance {\n        raft_multiplier = 1\n      }\n      server = true\n      bootstrap_expect = 3\n      ui = true\n      client_addr = \"0.0.0.0\"\n      advertise_addr = \"10.10.30.101\"\n      auto_encrypt {\n        allow_tls = true\n      }\n  - path: /etc/consul.d/consul-agent-ca.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\n      EwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\n      ZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\n      LjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\n      NzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\n      qaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\n      Fy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\n      AQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\n      BgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\n      hkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\n      XClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIICqDCCAk2gAwIBAgIRAM+wX1p9xL9Y5QgSMPdoCWQwCgYIKoZIzj0EAwIwgbkx\n      CzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\n      bzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\n      FQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\n      IDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\n      MTAwMjM3MDdaFw0yMjA4MTAwMjM3MDdaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\n      ZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASLUQdY9KOz/76D\n      hpue/erFWF6Om7uFLncy8hCz00KaSTB412ElNIBtT59ftUPsu75I7YnlJ4Kf8qo4\n      N3uw+WzCo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\n      AQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgQxlyuL8KQd9Mwj3M\n      u1x9D4wO7pWeU+IublKxSoZ6CpAwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\n      xNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\n      bnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0kAMEYCIQCYBeSJ3WOv\n      WO/jrdOIo1vKMomDfVZ8Hh1w9n/t8+ziBwIhALQJbGsxv96gKfEmcxh624syGXBC\n      skzUwQf5XNYARQaV\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0-key.pem\n    content: |\n      -----BEGIN EC PRIVATE KEY-----\n      MHcCAQEEIC5ByiRFJaGg4eU4F7PPhspehHDDzwrKu0IfJevvUqQroAoGCCqGSM49\n      AwEHoUQDQgAEi1EHWPSjs/++g4abnv3qxVhejpu7hS53MvIQs9NCmkkweNdhJTSA\n      bU+fX7VD7Lu+SO2J5SeCn/KqODd7sPlswg==\n      -----END EC PRIVATE KEY-----\n  - path: /etc/systemd/system/consul.service\n    content: |\n      [Unit]\n      Description=\"HashiCorp Consul - A service mesh solution\"\n      Documentation=https://www.consul.io/\n      Requires=network-online.target\n      After=network-online.target\n      ConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n      [Service]\n      Type=notify\n      User=consul\n      Group=consul\n      ExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\n      ExecReload=/bin/kill --signal HUP $MAINPID\n      KillMode=process\n      KillSignal=SIGTERM\n      Restart=on-failure\n      LimitNOFILE=65536\n\n      [Install]\n      WantedBy=multi-user.target\nruncmd:\n  - sudo apt-get update\n  - sudo apt-get install -y zip curl\n  - cd /tmp/\n  - curl -sSL  https://releases.hashicorp.com/consul/1.10.1/consul_1.10.1_linux_amd64.zip \u003e consul.zip\n  - unzip consul.zip\n  - sudo chown consul:consul consul\n  - sudo chmod +x consul\n  - sudo mv consul /usr/local/bin/\n  - rm /tmp/consul.zip\n  - sudo mkdir -p /var/lib/consul\n  - sudo chown -R consul:consul /var/lib/consul\n  - sudo chmod -R 775 /var/lib/consul\n  - sudo systemctl enable consul\n  - sudo systemctl start consul\n\r\n--MIMEBOUNDARY--\r\n"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "part"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "content"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "part"
              },
              {
                "type": "index",
                "value": {
                  "value": 1,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "content"
              }
            ]
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[2].module.cloud-init-vm",
      "mode": "data",
      "type": "vault_generic_secret",
      "name": "proxmox_node_settings",
      "provider": "provider[\"registry.terraform.io/hashicorp/vault\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "data": {
              "host": "10.10.30.97",
              "password": "Forever!6+7",
              "storage": "skypiea-zfs",
              "username": "root"
            },
            "data_json": "{\"host\":\"10.10.30.97\",\"password\":\"Forever!6+7\",\"storage\":\"skypiea-zfs\",\"username\":\"root\"}",
            "id": "secret/home/proxmox/skypiea",
            "lease_duration": 0,
            "lease_id": "",
            "lease_renewable": false,
            "lease_start_time": "RFC2229",
            "path": "secret/home/proxmox/skypiea",
            "version": -1
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "path"
              }
            ]
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[2].module.cloud-init-vm",
      "mode": "managed",
      "type": "null_resource",
      "name": "cloud_init_config_files",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "8333773121379533986",
            "triggers": {
              "file_content": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\n#cloud-config\nusers:\n  - default\n  - name: ubuntu\n    shell: /bin/bash\n    home: /home/ubuntu\n    lock_passwd: true\n    groups: sudo, users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\nssh_deletekeys: true\nwrite_files:\n  - path: /etc/ssh/trusted-user-ca-keys.pem\n    content: |\n      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQClrViOmThAHehEVvHM0Q0zDmovoT+U1R154tfT7ONlJ5MTjPyDWlc3akoEn3j49vS45tfgoepHoYRD+GfaABrwTcJ7y60CvmQJeYebf/xhM+4E8zwRfqPTisYCSch4EzRzmGlKEfxkme0JGnWkD11NNF7hYTm8vrMiwA3e/RABGHdHQNW8fAhCV/rfGYmlzDo2dkgmYgCVbPbdUcZ6wqe+GEDAi2buhQO0AiZwlM1PMPLAFUC5JgnCY9MkJjnfhPY3A0MnqWedpicTieE1TmPBNlYltCW5ASNMSIeFmyeFAHVqBFWNVxNxiwQrJba7m6Z30wYhkxE2nXLNIGBDo9okwYLWA0fl2NHRQEJ3z389uaCl7E+EayVUFLueWSmQC69nu1KgMC4+V2ZQzD6LfKEgbNSrMleDtSbMHrDKBl5V1DGrxvKtd/bMwKu7bA0a03dTN7PzB8AwajPi9GWGjyMOk563JaCeZuEWTPxdnapGCl0IskGM4jky5yj18XrpKp3/1ZnhYkhQjbh0JOZwedyX180lzEc+ZGIqPARaEHTWgTbXClkvdC7obtlzsHI5NZvj7tjAu79RnjX4Sztb/q7R0skpNtSeQ9BYsVw2V2HTMKo/XlZla+wUVA6cBWk0qhvSYrO4mpcYWBDOSyk+e+xZeBE6cP3gmJSBwFr9ZhQj9Q==\n\nbootcmd:\n  - cloud-init-per once ssh-users-ca echo \"TrustedUserCAKeys /etc/ssh/trusted-user-ca-keys.pem\" \u003e\u003e /etc/ssh/sshd_config\npackage_update: true\npackage_upgrade: true\nhostname: consul-server-3\npower_state:\n  timeout: 30\n  mode: reboot\n  message: Restarting\r\n--MIMEBOUNDARY\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\nX-Merge-Type: list(append) + dict(no_replace, recurse_list) + str()\r\n\r\nusers:\n  - name: consul\n    system: true\nwrite_files:\n  - path: /etc/consul.d/consul.hcl\n    content: |\n      datacenter = \"rayleigh\"\n      data_dir = \"/var/lib/consul\"\n      encrypt = \"Ho8aXP9AUv5P9InKGGBslmXRLeClesq0JgSWCOHmT0M=\"\n      ca_file = \"/etc/consul.d/consul-agent-ca.pem\"\n      cert_file = \"/etc/consul.d/dc1-server-consul-0.pem\"\n      key_file = \"/etc/consul.d/dc1-server-consul-0-key.pem\"\n      verify_incoming = true\n      verify_outgoing = true\n      verify_server_hostname = true\n      retry_join = [\"10.10.30.99\",\"10.10.30.100\",\"10.10.30.101\"]\n      performance {\n        raft_multiplier = 1\n      }\n      server = true\n      bootstrap_expect = 3\n      ui = true\n      client_addr = \"0.0.0.0\"\n      advertise_addr = \"10.10.30.101\"\n      auto_encrypt {\n        allow_tls = true\n      }\n  - path: /etc/consul.d/consul-agent-ca.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIIC7DCCApOgAwIBAgIQY4mtYLPiyiDLQtyNfFuEHTAKBggqhkjOPQQDAjCBuTEL\n      MAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1TYW4gRnJhbmNpc2Nv\n      MRowGAYDVQQJExExMDEgU2Vjb25kIFN0cmVldDEOMAwGA1UEERMFOTQxMDUxFzAV\n      BgNVBAoTDkhhc2hpQ29ycCBJbmMuMUAwPgYDVQQDEzdDb25zdWwgQWdlbnQgQ0Eg\n      MTMyMzA4NDMyNzcwNzYyOTY0NDI3MTcwODYzNzgwMjA0MzQ4NDQ1MB4XDTIxMDgx\n      MDAyMzExNVoXDTI2MDgwOTAyMzExNVowgbkxCzAJBgNVBAYTAlVTMQswCQYDVQQI\n      EwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzEaMBgGA1UECRMRMTAxIFNlY29u\n      ZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcwFQYDVQQKEw5IYXNoaUNvcnAgSW5j\n      LjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENBIDEzMjMwODQzMjc3MDc2Mjk2NDQy\n      NzE3MDg2Mzc4MDIwNDM0ODQ0NTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH/+\n      qaBGNXfmN7XJerFBLjjV0rD9BDIF1eJDeUQAj5e40UaS5dZhWpYg0kpMHA+4KBAu\n      Fy07ndU7F/AlcJO2ynyjezB5MA4GA1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTAD\n      AQH/MCkGA1UdDgQiBCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAr\n      BgNVHSMEJDAigCDazRfGX41kwbBSvo+wkgvE2L7mFiV93a2lC1aP6xJc3zAKBggq\n      hkjOPQQDAgNHADBEAiBRslorcIldOKQp6b7vqi826Z1iyYZ8rXHXZO7fiAQcAAIg\n      XClWpgM/HAu7/zeKKag9IKvcJU7488zpmIq3OXw37S8=\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0.pem\n    content: |\n      -----BEGIN CERTIFICATE-----\n      MIICqDCCAk2gAwIBAgIRAM+wX1p9xL9Y5QgSMPdoCWQwCgYIKoZIzj0EAwIwgbkx\n      CzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNU2FuIEZyYW5jaXNj\n      bzEaMBgGA1UECRMRMTAxIFNlY29uZCBTdHJlZXQxDjAMBgNVBBETBTk0MTA1MRcw\n      FQYDVQQKEw5IYXNoaUNvcnAgSW5jLjFAMD4GA1UEAxM3Q29uc3VsIEFnZW50IENB\n      IDEzMjMwODQzMjc3MDc2Mjk2NDQyNzE3MDg2Mzc4MDIwNDM0ODQ0NTAeFw0yMTA4\n      MTAwMjM3MDdaFw0yMjA4MTAwMjM3MDdaMCExHzAdBgNVBAMTFnNlcnZlci5yYXls\n      ZWlnaC5jb25zdWwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASLUQdY9KOz/76D\n      hpue/erFWF6Om7uFLncy8hCz00KaSTB412ElNIBtT59ftUPsu75I7YnlJ4Kf8qo4\n      N3uw+WzCo4HMMIHJMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcD\n      AQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADApBgNVHQ4EIgQgQxlyuL8KQd9Mwj3M\n      u1x9D4wO7pWeU+IublKxSoZ6CpAwKwYDVR0jBCQwIoAg2s0Xxl+NZMGwUr6PsJIL\n      xNi+5hYlfd2tpQtWj+sSXN8wMgYDVR0RBCswKYIWc2VydmVyLnJheWxlaWdoLmNv\n      bnN1bIIJbG9jYWxob3N0hwR/AAABMAoGCCqGSM49BAMCA0kAMEYCIQCYBeSJ3WOv\n      WO/jrdOIo1vKMomDfVZ8Hh1w9n/t8+ziBwIhALQJbGsxv96gKfEmcxh624syGXBC\n      skzUwQf5XNYARQaV\n      -----END CERTIFICATE-----\n  - path: /etc/consul.d/dc1-server-consul-0-key.pem\n    content: |\n      -----BEGIN EC PRIVATE KEY-----\n      MHcCAQEEIC5ByiRFJaGg4eU4F7PPhspehHDDzwrKu0IfJevvUqQroAoGCCqGSM49\n      AwEHoUQDQgAEi1EHWPSjs/++g4abnv3qxVhejpu7hS53MvIQs9NCmkkweNdhJTSA\n      bU+fX7VD7Lu+SO2J5SeCn/KqODd7sPlswg==\n      -----END EC PRIVATE KEY-----\n  - path: /etc/systemd/system/consul.service\n    content: |\n      [Unit]\n      Description=\"HashiCorp Consul - A service mesh solution\"\n      Documentation=https://www.consul.io/\n      Requires=network-online.target\n      After=network-online.target\n      ConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n      [Service]\n      Type=notify\n      User=consul\n      Group=consul\n      ExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\n      ExecReload=/bin/kill --signal HUP $MAINPID\n      KillMode=process\n      KillSignal=SIGTERM\n      Restart=on-failure\n      LimitNOFILE=65536\n\n      [Install]\n      WantedBy=multi-user.target\nruncmd:\n  - sudo apt-get update\n  - sudo apt-get install -y zip curl\n  - cd /tmp/\n  - curl -sSL  https://releases.hashicorp.com/consul/1.10.1/consul_1.10.1_linux_amd64.zip \u003e consul.zip\n  - unzip consul.zip\n  - sudo chown consul:consul consul\n  - sudo chmod +x consul\n  - sudo mv consul /usr/local/bin/\n  - rm /tmp/consul.zip\n  - sudo mkdir -p /var/lib/consul\n  - sudo chown -R consul:consul /var/lib/consul\n  - sudo chmod -R 775 /var/lib/consul\n  - sudo systemctl enable consul\n  - sudo systemctl start consul\n\r\n--MIMEBOUNDARY--\r\n"
            }
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "triggers"
              },
              {
                "type": "index",
                "value": {
                  "value": "file_content",
                  "type": "string"
                }
              }
            ]
          ],
          "private": "bnVsbA==",
          "dependencies": [
            "module.proxmox.module.consul_server.data.cloudinit_config.config",
            "module.proxmox.module.consul_server.module.cloud-init-vm.data.vault_generic_secret.proxmox_node_settings",
            "data.consul_keys.config",
            "module.local_vault.vault_mount.vm-client-signer",
            "module.local_vault.vault_ssh_secret_backend_ca.ca",
            "module.local_vault.vault_ssh_secret_backend_role.mac",
            "module.proxmox.data.vault_generic_secret.consul_config"
          ]
        }
      ]
    },
    {
      "module": "module.proxmox.module.consul_server[2].module.cloud-init-vm",
      "mode": "managed",
      "type": "proxmox_vm_qemu",
      "name": "cloud-init-server",
      "provider": "provider[\"registry.terraform.io/telmate/proxmox\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "additional_wait": 15,
            "agent": 0,
            "args": "",
            "balloon": 0,
            "bios": "seabios",
            "boot": "cdn",
            "bootdisk": "scsi0",
            "bridge": "",
            "ci_wait": null,
            "cicustom": "user=images:snippets/cloud-init-consul-server-3.yml",
            "cipassword": "",
            "ciuser": "",
            "clone": "ubuntu-cloudinit",
            "clone_wait": 15,
            "cloudinit_cdrom_storage": "skypiea-zfs",
            "cores": 1,
            "cpu": "host",
            "default_ipv4_address": "",
            "define_connection_info": true,
            "desc": "",
            "disk": [
              {
                "backup": 0,
                "cache": "none",
                "discard": "",
                "file": "vm-103-disk-0",
                "format": "raw",
                "iothread": 1,
                "mbps": 0,
                "mbps_rd": 0,
                "mbps_rd_max": 0,
                "mbps_wr": 0,
                "mbps_wr_max": 0,
                "media": "",
                "replicate": 0,
                "size": "20G",
                "slot": 0,
                "ssd": 0,
                "storage": "skypiea-zfs",
                "storage_type": "zfspool",
                "type": "scsi",
                "volume": "skypiea-zfs:vm-103-disk-0"
              }
            ],
            "disk_gb": 0,
            "force_create": false,
            "force_recreate_on_change_of": null,
            "full_clone": true,
            "guest_agent_ready_timeout": 120,
            "hastate": "",
            "hotplug": "network,disk,usb",
            "id": "skypiea/qemu/103",
            "ipconfig0": "ip=10.10.30.101/24,gw=10.10.30.1",
            "ipconfig1": "",
            "ipconfig2": "",
            "iso": null,
            "kvm": true,
            "mac": "",
            "memory": 1024,
            "name": "consul-server-3",
            "nameserver": "",
            "network": [
              {
                "bridge": "vmbr0",
                "firewall": false,
                "link_down": false,
                "macaddr": "2A:B2:A2:61:99:09",
                "model": "virtio",
                "queues": 0,
                "rate": 0,
                "tag": -1
              }
            ],
            "nic": "",
            "numa": false,
            "onboot": true,
            "os_network_config": null,
            "os_type": "cloud-init",
            "pool": "",
            "preprovision": true,
            "qemu_os": "other",
            "reboot_required": false,
            "scsihw": "virtio-scsi-pci",
            "searchdomain": "",
            "serial": [],
            "sockets": 1,
            "ssh_forward_ip": null,
            "ssh_host": "10.10.30.101",
            "ssh_port": "22",
            "ssh_private_key": null,
            "ssh_user": null,
            "sshkeys": "",
            "storage": "",
            "storage_type": "",
            "tags": "",
            "target_node": "skypiea",
            "unused_disk": [],
            "vcpus": 0,
            "vga": [],
            "vlan": -1,
            "vmid": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "ipconfig0"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "disk"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "storage"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "cloudinit_cdrom_storage"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "target_node"
              }
            ]
          ],
          "private": "bnVsbA==",
          "dependencies": [
            "module.proxmox.data.vault_generic_secret.consul_config",
            "module.proxmox.module.consul_server.module.cloud-init-vm.data.vault_generic_secret.proxmox_node_settings",
            "data.consul_keys.config",
            "data.vault_generic_secret.proxmox_credentials",
            "module.local_vault.vault_mount.vm-client-signer",
            "module.local_vault.vault_ssh_secret_backend_ca.ca",
            "module.local_vault.vault_ssh_secret_backend_role.mac"
          ]
        }
      ]
    }
  ]
}
